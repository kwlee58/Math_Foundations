---
title: "Chapter 4 lab"
author: "coop711"
date: "`r Sys.Date()`"
output: html_document
---


## 1. 

* 주의 : 왼쪽 행렬식과 오른쪽 행렬식 간의 등호는 왼쪽 행렬식의 행과 열을 조작해서 오른쪽 행렬식이 나온다는 뜻이 아니고 __행렬식의 계산 결과가 같다__ 는 의미임.

### (a)

* 행렬 구성. 

```{r}
(A1 <- matrix(c(1, 3, 6, 5, 2, -2, -5, -5, -5), 3))
(A2 <- matrix(c(-3, -3, -2, 2, 5, 3, -6, -7, -4), 3))
```

* 행렬식 계산 

```{r}
det(A1)
det(A2)
```
* 수작업 과정을 옮겨보면, 
    + 1이 앞에 나오는 열을 두번째 열과 세번째 열의 첫 원소를 0으로 만드는 데 사용

```{r}
A1.2 <- A1
A1.2[, 2] <- A1[, 2] - A1[, 1]*5
A1.2
A1.2[, 3] <- A1[, 3] - A1[, 1]*(-5)
A1.2
```

* 최종  결과 계산,  굳이 `A1.2[2:3, 2:3]` 대신에 `A1.2[-1, -1]`로 표현한 이유를 생각해 볼 것.

```{r}
A1.2[1, 1] * det(A1.2[-1, -1])
```

* 오른쪽 행렬에 대해서는 첫번째 행을 두번째 행과 세번째 행의 첫번째 원소를 0으로 만드는 데 사용

```{r}
A2.2 <- A2
A2.2[2, ] <- A2.2[2, ] - A2.2[1, ]
A2.2
A2.2[3, ] <- A2.2[3, ] - A2.2[1, ]*(2/3)
A2.2
```

* 최종 결과 계산 

```{r}
A2.2[1, 1]*det(A2.2[-1, -1])
```

### (b)

* 행렬 구성

```{r}
(B1 <- matrix(c(2, -2, 2, 6, 7, -7, 5, -5, 9), 3))
(B2 <- matrix(c(2, -1, 3, -1, 7, -21, 9, 2, 2), 3))
```

* 행렬식 계산

```{r}
det(B1)
det(B2)
```
* 수작업 과정을 옮겨보면, 
    + 첫번째 행을 두번째 행과 세번째 행의 첫 원소를 0으로 만드는 데 사용

```{r}
B1.2 <- B1
B1.2[2, ] <- B1.2[2, ] + B1.2[1, ]
B1.2
B1.2[3, ] <- B1.2[3, ] - B1.2[1, ]
B1.2
```

* 최종 결과 계산

```{r}
B1.2[1, 1] * det(B1.2[-1, -1])
```

* 오른쪽 행렬에 대해서는 두번째 행을 이용하여 첫번째 행과 세번째 행의 첫 원소를 0으로 만듦.

```{r}
B2.2 <- B2
B2.2[1, ] <- B2.2[1, ] + 2 * B2.2[2, ]
B2.2
B2.2[3, ] <- B2.2[3, ] + 3 * B2.2[2, ]
B2.2
```

* 최종 결과 계산, __소행렬식의 표현 방법__ 에 유의.

```{r}
(-1) * B2.2[2, 1] * det(B2.2[-2, -1])
```

### (c)

* 행렬 구성, `rep()` 함수의 활용 방법에 유의.

```{r}
(C1 <- matrix(c(1:4, 6, 8, 8, 9, 4, 5, 7, 7, 3:5, 7), 4))
(C2 <- matrix(c(1, rep(-1, 3), -1, 1, -1, -1, rep(c(-1, 1), each = 2), rep(-1, 4)), 4))
```

* 행렬식 계산, __같지 않음!__
    + 영문판 원본에는 `C2[4, 3] = -1`로 되어 있음.  고쳐서 계산해도 같은 결과가 나오지는 않음.

```{r}
C2.2 <- C2
C2.2[4, 3] <- -1
C2.2
det(C2.2)
```
* `C1`을 상삼각행렬로 만들어 행렬식을 계산하면, 

```{r}
C1.2 <- C1
C1.2[2, ] <- C1.2[2, ] - C1.2[2, 1] * C1.2[1, ]
C1.2
C1.2[3, ] <- C1.2[3, ] - C1.2[3, 1] * C1.2[1, ]
C1.2
C1.2[4, ] <- C1.2[4, ] - C1.2[4, 1] * C1.2[1, ]
C1.2
C1.2[3, ] <- C1.2[3, ] - (C1.2[3, 2]/C1.2[2, 2]) * C1.2[2, ]
C1.2
C1.2[4, ] <- C1.2[4, ] - (C1.2[4, 2]/C1.2[2, 2]) * C1.2[2, ]
C1.2
C1.2[4, ] <- C1.2[4, ] - (C1.2[4, 3]/C1.2[3, 3]) * C1.2[3, ]
C1.2
prod(diag(C1.2))
```

* 수정하기 이전의 `C2`는 첫번째, 두번째, 세번째 열(행)을 다 더하면 마지막 열(행)이 되기 때문에 행렬식 = 0임. 수정된 `C2.2`의 행렬식을 구하는 과정은 
    + 행렬의 구조를 잘 들여다보면 첫번째, 두번째, 세번째 열에서 네번째 열을 그대로 빼 주면 계산하기 쉬운 구조가 얻어질 것으로 보임.
    
```{r}
C2.2[, 1] <- C2.2[, 1] - C2.2[, 4]
C2.2
C2.2[, 2] <- C2.2[, 2] - C2.2[, 4]
C2.2
C2.2[, 3] <- C2.2[, 3] - C2.2[, 4]
C2.2
prod(diag(C2.2))
```

### (d)

* 행렬 구성

```{r}
(D1 <- matrix(c(21, 12, 13, 1, 6, 16, 10, 93, 3, 36, 19, 81, 9, 4, 5, 6), 4))
(D2 <- matrix(c(4, -1, 2, 7, 8, 6, -7, -8, 9, 3, 8, 2, 12, 17, 6, 1, 3, 7, 27, 2, 2, 1, 4, -5, 37), 5))
```

* 행렬식 계산
    + `options(digits = 2)` 대신에 굳이 `round(, digits = 2)` 를 사용한 이유는?

```{r}
round(det(D1), digits = 2)
round(det(D2), digits = 2)
```

* `D1`의 구조 탐색
    + 첫번째 행의 각 원소를 공통인수 3으로 나누고, 두번째 행의 각 원소를 공통인수 중 2로 나누면, 세번째 행이 
    바로 첫번째 행과 두번째 행의 합임을 알게 됨. 따라서 행렬식은 0이됨.

```{r}
(D1.2 <- D1)
D1.2[1, ] <- D1.2[1, ]/3
D1.2
D1.2[2, ] <- D1.2[2, ]/2
D1.2
```

* 이와 같이 정리한 행렬에서 첫번째 행과 두번째 행을 합하여 세번째 행을 빼는 과정을 행렬의 곱으로 표현하면

```{r}
(M12.minus.3 <-matrix(c(1, 0, 1, 0, 0, 1, 1, 0, 0, 0, -1, 0, 0, 0, 0, 1), 4))
M12.minus.3 %*% D1.2
```

* `D2`의 구조 탐색
    + 두번째 행을 (-2)배 하면, 첫번째 행이 두번째 행과 세번째 행의 합임을 알 수 있음. 따라서 행렬식은 0이 됨.
    
```{r}
D2.2 <- D2
D2.2[2, ] <- (-2) * D2.2[2, ] 
D2.2
```

* 두번째 행과 세번째 행을 합하여 첫번째 행에서 빼 주는 과정을 행렬의 곱으로 표현하면

```{r}
(M23.minus.1 <- matrix(c(-1, rep(0, 4), 1, 1, rep(0, 3), 1, 0, 1, 0, 0, rep(0, 3), 1, 0, rep(0, 4), 1), 5))
M23.minus.1 %*% D2.2
```

## 2.

### (a)

* 전위수의 차이로 인한 부호 바뀜에 유의.

```{r}
(A3 <- matrix(c(1, 2, 4, 0, 3, 5, 0, 0, 6), 3))
(A3.2 <- A3[, 3:1])
det(A3)
det(A3.2)
```

### (b)

```{r}
(A4 <- matrix(c(1, 2, 4, 7, 0, 3, 5, 8, 0, 0, 6, 9, 0, 0, 0, 10), 4))
(A4.2 <- A4[, 4:1])
det(A4)
det(A4.2)
```

## 4.

* `a, b, c, d, e, f`를 `r 1:6` 인 경우에 대하여 예시

* 자료 구성

```{r}
a <- 1; b <- 2; c <- 3; d <- 4; e <- 5; f <- 6
(A5 <- matrix(c(0, a, -b, c, -a, 0, d, -e, 2, -d, 0, f, -c, e, -f, 0), 4))
```

### (a)

```{r}
det(A5)
(a*f + c*d - b*e)^2
```

### (b)

```{r}
diag(4)
diag(4) + A5
1 + a^2 + b^2 + c^2 + d^2 + e^2 + f^2
1 + a^2 + b^2 + c^2 + d^2 + e^2 + f^2 + det(A5)
det(diag(4) + A5)
```

### (c)

```{r}
(B5 <- diag(4) + A5)
B5[, 2] <- B5[, 2] + B5[, 1]
B5
B5[, 3] <- B5[, 3] - 2 *  B5[, 1]
B5
B5[, 4] <- B5[, 4] - (-3) *  B5[, 1]
B5
B5[, 3] <- B5[, 3] - B5[2, 3]/B5[2, 2] *  B5[, 2]
B5
B5[, 4] <- B5[, 4] - B5[2, 4]/B5[2, 2] *  B5[, 2]
B5
B5[, 4] <- B5[, 4] - B5[3, 4]/B5[3, 3] *  B5[, 3]
B5
prod(diag(B5))
```

